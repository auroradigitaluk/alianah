/**
 * Run once (or when logos change) to bake logo base64 into lib/email-logo-data.generated.ts.
 * Ensures logos load in all emails regardless of server filesystem.
 */
const fs = require("fs")
const path = require("path")

const projectRoot = path.join(__dirname, "..")
const publicDir = path.join(projectRoot, "public")
const lightPath = path.join(publicDir, "logo light.png")
const darkPath = path.join(publicDir, "logo dark.png")
const outPath = path.join(projectRoot, "lib", "email-logo-data.generated.ts")

if (!fs.existsSync(lightPath) || !fs.existsSync(darkPath)) {
  console.error("Missing public/logo light.png or public/logo dark.png")
  process.exit(1)
}

const lightBase64 = fs.readFileSync(lightPath).toString("base64")
const darkBase64 = fs.readFileSync(darkPath).toString("base64")

const content = `// Generated by scripts/inline-email-logos.js â€“ do not edit by hand.
export const LOGO_LIGHT_DATA_URI = "data:image/png;base64,${lightBase64}"
export const LOGO_DARK_DATA_URI = "data:image/png;base64,${darkBase64}"
`

fs.writeFileSync(outPath, content, "utf8")
console.log("Wrote lib/email-logo-data.generated.ts")
